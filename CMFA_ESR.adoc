= Biometric Product Essential Security Requirements - CMFA
:showtitle:
:toc:
:toclevels: 3
:table-caption: Table
:imagesdir: images
:revnumber: 0.1
:revdate: January 14, 2021
:xrefstyle: full

:iTC-longname: Biometrics Security
:iTC-shortname: BIO-iTC
:iTC-email: isec-itc-bio-info@ipa.go.jp
:iTC-website: https://biometricitc.github.io/
:iTC-GitHub: https://github.com/biometricITC/cPP-biometrics
:iTC-ITname: BIT

[cols=".^1,.^1"]
|===

|Title
|Biometric Product Essential Security Requirements - CMFA

|Maintained by
|Biometrics Security iTC

|Version
|{revnumber}

|Date of Issue
|{revdate}

|Supersedes
|

|===

== Status
[NOTE]
====
This section needs to be reviewed
====
The {itc-longname} iTC has been requested by vendors to develop an Essential Security Requirements (ESR) for Continuous Multifactor Authentication (CMFA) products. The CMFA ESR version 1.0 contains material generated by the members of the {itc-shortname}, for a PP-Module to be reviewed by the membership of the {itc-shortname} and endorsed in 2021.

=== References
[NOTE]
====
This section will be updated later
====
* [#BIOPP-Module]#[BIOPP-Module]# - collaborative PP-Module for Biometric enrolment and verification - for unlocking the device - [BIOPP-Module]

== Background and Purpose

This document describes the high-level fundamental security requirements expected of any computer devices that implement CMFA. It is intended to provide a minimal, baseline set of requirements which can be built upon by the future PP-Module to provide an overall set of security solutions for CMFA running on a computer device.

=== Conventional authentication
Most computer devices implement user authentication functionality. In case of a mobile device, [MDFPP] requires the mobile device to authenticate a user with password or biometrics and lock the user after the fixed time of inactivity. We call this type of authentication "conventional authentication" hereafter. A user is required to succeed this conventional authentication to verify the user correctly for unlocking the device.

Conventional authentication suffers from several shortcomings such as the inconvenience of frequent unlocking and several adversarial attacks (e.g., shoulder surfing and smudge attacks for password authentication). CMFA extends the conventional authentication and delivers continuous and transparent authentication to reduce such shortcomings.

=== CMFA
CMFA determines the current level of authentication of a user, the trust score, using inputs received through sensors or components attached to a computer device. This trust score achieves the highest score right after the conventional authentication succeeds and begins to decline as time progresses. However, CMFA increases the trust score, for example, if CMFA recognizes user’s voice from a microphone, or maintain the trust score, for example, if CMFA recognizes that the device is in a known place (e.g. office) and sign in to the known WiFi network. CMFA also learn or analyze behavior patterns of a user and decreases the score if unusual behavior is detected (e.g. install an app from untrusted source). 

The trust score is continuously updated and passed to the computer device and the device keeps unlocked state or transit to the locked state based on the score. The trust score can also be provided to external program or service for more granular access control. 

==== CMFA boundary
CMFA, the TOE, is composed of the hardware (e.g. sensor), firmware and software attached or running on the computer device. CMFA determines the trust score and pass it to the computer device (or external services) and the device (out of scope of the TOE) ,based on the trust score, is responsible to keep the unlocked state or transit to the locked state and protect the sensitive data during the locked state.

An example of a CMFA boundary within the overall context of the inputs used for continuous authentication is shown below.

.Example CMFA Boundary
image::toe-boundary.png[width=80%,align="center"]

* The purple boundary is the CMFA TOE, including the CMFA Engine, the CMFA Signal Verification and the Admin interface
** CMFA Engine is the core of system, determining the trust score based on inputs from sensors and configuration data
** CMFA Signal Verification is used to ensure trust of the incoming sensor/connection input (Yellow boxes)
** Admin is the component that received configuration data from the external management service (such as an EMM)
* The orange Biometric Sensors & PAD are for any dedicated biometric sensors (such as face, fingerprint or vein) that are used for the conventional authentication (or has been validated to) the requirements of [BIOPP-Module]. CMFA Engine set the trust score to the highest value when biometric verification using these dedicated biometric sensors succeeds. Biometric sensors (e.g. microphone for voice) that are not the dedicated biometric ones may also be used to maintain or increase the trust score.
* The yellow sensors/connection input can cover any type of input that may be used. For example, the type of Wi-Fi connection, location data, time or wearable device connectivity.
The different color lines are used to show an example of paths and the level of trust that is associated with the input.

* Black lines show "internal" communications between components
* Green lines show highly trusted input (trust established both by the source and the path to the TOE) that can be trusted fully without additional checks (and hence is input directly to the CMFA Engine)
* Red lines show less trusted input that must be checked before being used
* Yellow, dashed lines show potential alternative paths for sources (generally for sources that may be normally considered highly trusted but which may want to be separately verified anyway)

==== CMFA configuration
The configuration process for CMFA is likely to encompass multiple steps, covering both user and administrator actions. The user may provide biometric data for user enrollment if additional biometric sensor is configured, or select external devices to use as sensor input. The administrator may provide configuration information such as acceptable Wi-Fi networks, time settings, location data or specific sensors to be used. This combination of information provided by the user and administrator would be used for configuration of CMFA.

== Use Case(s)
CMFA are used primarily for continuously authentication of a user for computer devices such as smartphones, where the trust score is used to determine the state of the computer device. 

This trust score can also be provided to external services such as a PC login at the office, building or room entrance control or ATMs. Those external services can communicate CMFA through a computer device so that the external services can request additional user data using specific sensor to increase the trust score before granting the access to a user.

The first version of the PP-Module focuses on the use case that the CMFA is used for continuously authentication to determine the state of a computer device. Additional PP-Modules have to be created for other use cases.

== Resources to be protected
The trust score that is determined by the CMFA and passed to the computer device. 
Any personal information gathered by CMFA, such as biometric information and behavior patterns of a user.
Any data used to determine the trust score including CMFA configuration data.
(User data stored on the computer device shall be protected by the computer device itself)

== Attacker access
An attacker can steal the computer device in the unlocked state however an attacker needs to take some actions (e.g. take the device out of office that GPS can detect) before accessing CMFA data, user data or service stored in the computer device.

[If biometric sensor is used for CMFA, an attacker may present any kind of presentation attack instruments during enrolment and verification for the sake of impersonation.]

[If biometric sensor is used for CMFA, an attacker may try to spoof sensor/connection input during enrolment and verification for the sake of impersonation.]

Normal Italicized text indicates attacker access related to Essential Security Requirements and (Italicized text within square parenthesis) indicate ones related to Optional Extensions.

== Attacker Resources
Any resources allowed to be used by the basic attack potential to examine and attack CMFA and sensors used by CMFA
Commercially and/or publicly available software/knowledge/equipment, and, if it is commercially available, samples of the computer device running CMFA to test and attack

== Boundary of Device
The hardware, firmware, software and security functionalities of the CMFA define the boundary

All of the security functionalities are contained and executed within the boundary of the CMFA
(Refer “CMFA boundary” for more information)

== Essential Security Requirements
*CMFA shall allow a user or administrator to select or de-select sensors for continuous authentication.* 

Note for iTC members (this description will be removed from the final ESR): Explicit user permission is required if CMFA monitors detailed user behavior pattern for continuous authentication. CMFA shall not collect sensitive personal information without explicit user permission.

*CMFA shall configure adequate set of sensors for continuous authentication.*

Note for iTC members: CMFA shall not use only one sensor that is easy to spoof (e.g. microphone) or sensor that pass input to CMFA through non-secure execution environment. CMFA shall always use multiple sensors (e.g. GPS, WiFi and microphone) that can’t be spoofed at once by a Basic potential attacker. Some guidance should be provided in the SD about how to determine the adequate set of sensors.

*CMFA shall continuously determines the current level of authentication of a user based on inputs from sensors and configuration data.*

Note for iTC members: PP-module defines SFRs that correspond to this requirement (see below) and SD describes evaluation activities to test those SFR (e.g. take the device out of the office and check the device is locked immediately after evaluator move the device far away enough from registered (trusted) place) 

_TOE shall determine the trust score with following rule:_

_Increase the score when [Assignment: some conditions (e.g. recognize a user’s voice] are met_ 

_Decrease the score when [Assignment: some conditions (e.g. located in untrusted location)] are met_

_Keep the score when [Assignment: some conditions (e.g. signing into the company wifi)] are met_

_Reset the score when [Assignment: some conditions (e.g. detect sensor failure)]_

If CMFA use machine learning (i.e train the model using user behavior pattern and calculate the trust score from the trained model), we should discuss how to handle such TOE during the development of PP-module and SD.

*CMFA shall protect any data, especially sensitive personal information. used for continuous authentication in cooperation with its operating environment.*

Note for iTC members: sensitive personal information shall be protected securely and shall not be transmitted to the entity outside of the secure execution environment without explicit user permission (because it breaks the personal information protection law like GDPR)

*If additional biometric sensor is selected for CMFA, CMFA shall use inputs of sufficient quality and verify users less than claimed error rates (i.e. FAR and FRR)*

Note for iTC members: BIO-PP Module and SD can be reused for this requirement 

== Assumption
*A computer device conforms to the relevant PP and assume to be secure*

*A dedicated biometric sensor conforms to the relevant PP and assume to be secure*

Note for iTC members: CMFA depends on two components to operate as specified, a computer device and dedicated biometric sensors used for conventional authentication. This ESR assumes that both components conform the relevant PPs.

A computer device is responsible for locking device based on the trust score, protecting the data during the locked stat and maintain the secure execution environment for CMFA. Those security requirements are defined in the relevant PP such as [MDFPP].

Dedicated biometric sensors is responsible for verifying a user and protect user’s biometric information. Those security requirements are defined in the relevant PP such as [BIOPP-Module].

*Admin or user configures the CMFA and its environment correctly in a manner to ensure that the security policies will be enforced*

*A computer device that run CMFA is assumed to be used in a controlled and observable environment*

Note for iTC members: It is assumed that an attacker can steal the unlocked device but need to take some actions to steal user data from the device, such as taking the device out of office building that can be detected by GPS. Those actions that CMFA must identify from sensor inputs will be described in the PP and CMFA will be tested to work as specified.

== Optional Extensions

Requirements captured in this section may already be realized in some products in this technology class, but this ESR is not mandating these capabilities exist in “baseline” level products.

*CMFA shall train and develop a accurate model that can continuously determine the current level of authentication of a user* 

Note for iTC members: I heard that some products use machine learning to predict the current user status but such CMFA is out of scope in this ESR.

== Outside the Scope of Evaluation
*none*

Note for iTC members: We should list any functions provided by the TOE (CMFA) but out of scope of this ESR. I think the all CMFA functional requirements are covered by this ESR.
